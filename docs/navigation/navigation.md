# 导航和功能设计

计费周期：一个小时，或者每次上级管理员修改分配的资源后，计费周期重置。每次重置时扣一次费。实际扣费时计费周期的计费扣。

使用周期：一个小时，或每次使用资源的改变（比如增加一个实例、删除一个实例等）时，使用周期重置。使用周期会计算其中的费用，但是扣费不是按照使用周期的费率扣。可以把使用周期和计费周期看成两个完全无关的周期。

举例：

CPU使用单价：1元 1核 1小时

| 时间  | 操作                               | 计费周期     | 使用周期     | 分配的资源 | 使用的资源 | project应给domain付费                           | 使用周期计费                                |
| ----- | ---------------------------------- | ------------ | ------------ | ---------- | ---------- | ----------------------------------------------- | ------------------------------------------- |
| 00:00 | domain创建project                  | 1开始        | 1开始        | 2核        | 0核        | 0元                                             | 0元                                         |
| 00:01 | project下某个用户创建了1核的虚拟机 |              | 1结束，2开始 |            | 1核        |                                                 | 0元（使用周期1，0核）                       |
| 01:00 | 计费周期结束                       | 1结束，2开始 |              |            |            | 2元（计费周期1，分配2核，1个小时）              |                                             |
| 01:01 | 使用周期结束                       |              | 2结束，3开始 |            |            |                                                 | 1元（使用周期2，1核）                       |
| 01:10 | domain给project多分配2核           | 2结束，3开始 |              | 4核        |            | 2元（计费周期2，分配2核，不足1个小时按1个小时） |                                             |
| 01:40 | project下那个用户删除1核的虚拟机   |              | 3结束，4开始 |            | 0核        |                                                 | 1元（使用周期3，使用1核，不足1小时按1小时） |
| 02:10 | 计费周期结束                       | 3结束，4开始 |              |            |            | 4元（计费周期3，分配4核）                       |                                             |
| 02:40 | 使用周期结束                       |              | 4结束，5开始 |            |            |                                                 | 0元（使用周期5，0核）                       |
| 03:10 | 计费周期结束                       | 4开始        |              |            |            | 4元（计费周期4，分配4核）                       |                                             |

## Cloud Admin

- Identit（用户管理y
  - Domains（增删改查域，设置域默认管理员账号和密码）
- Expense（费用管理s
  - Dashboard（显示账号余额，提供充值入口；显示域应支，可以跳到Domain部分）
  - Transactions（交易记录，提供当前账号的交易信息：时间、交易额、原因、余额）
  - System（系统计费，显示和系统有关（给系统交的费用）的交易记录：时间、支付人、接收人、费用、原因（管理费、Domain资源支出））
  - Domains（域计费，分为分配和使用，分开显示）
    - Allocated（分配：显示各个**域**当前**计费周期**中**分配的资源**、**费率**、**当前支付人**、**上次扣款的时刻**和**支付人**。可以选择一个域，显示之前每个**计费周期**域**分配的资源**、**费用**、**支付人**）
    - Used（使用：显示各个**域**当前**使用周期**中**使用的资源**、**费率**。可以选择一个**域**，显示之前每个**使用周期**域**使用的资源**和**费用**）


## Domain Admin

- Identity（用户管理）
  - My Account（修改学号、邮箱、密码）
  - Projects（增删改查Project，修改给project分配的资源）
  - Users（增删改查Doamin中的Users，给User分配Project中的Role）
- Expenses（费用管理）
  - Dashboard（显示账号余额，提供充值入口；显示域当前计费周期的信息（见下Domain/Allocated），可以跳到Domain部分；显示各个项目当前计费周期信息的列表（见下Projects/Allocated），可以跳到Projects部分）
  - Transactions（账号交易记录，提供当前账号的交易信息：时间、交易额、原因、余额）
  - Domain（域计费）
    - Allocated（分配：显示当前域**计费周期**中**分配的资源**和**应交的费用**和**支付人**，可以修改支付人。再显示当前**域**之前所有**计费周期**被**分配的资源**和**费用**以及**支付人**。）
    - Used（使用：显示当前域**使用周期**中**使用的资源**和**分配资源应交的费用**。再显示当前**域**之前所有**使用周期**的**使用的资源**和**费用**。）
    - Transactions（交易记录，显示和当前域有关（项目给域钱、域给云钱，管理费）的交易记录：时间、支付人、接收人、费用、原因（管理费、项目资源收入、域资源支出））
  - Projects（项目计费）
    - Allocated（分配：显示各个项目当前**计费周期**中**分配的资源**、**费率**、**当前支付人**、**上次扣钱的时刻**和**支付人**。可以选择一个**项目**，显示之前每个**计费周期**项目**分配的资源**、**费用**、**支付人**）
    - Used（使用：显示各个项目当前**使用周期**中**使用的资源**和**费率**。可以选择一个**项目**，显示之前每个**使用周期**项目**使用的资源**和对应**费用**）


## Project Admin

- Identity
  - My Account（修改学号、邮箱、密码）
  - Projects (显示Domain中的所有Projects，只读)
  - Users （显示Project中的用户，给Project中的用户分配角色）
- Expenses
  - Dashboard（显示账号余额，提供充值入口；显示项目当前计费周期的信息（见下Project/Allocated），可以跳到Project部分；显示各个用户当前计费周期信息的列表（见下Users/Allocated），可以跳到Users部分）
  - Transactions（账号交易记录，提供当前账号的交易信息：时间、交易额、原因、余额）
  - Project（项目计费）
    - Allocated（分配：显示当前项目**计费周期**的**分配的资源**和**应交的费用**和**支付人**，可以修改支付人。再显示当前**项目**之前所有**计费周期**被**分配的资源**和**费用**以及**支付人**。）
    - Used（使用：显示当前项目**使用周期**的**使用的资源**和**分配资源应交的费用**。再显示当前**项目**之前所有**使用周期**的**使用的资源**和**费用**。）
    - Transactions（交易记录，显示和当前项目有关（项目给域钱，管理费）的交易记录：时间、支付人、接收人、费用、原因（管理费、项目资源支出）））
  - Users（用户计费）
    - Allocated（分配：显示各个用户当前**计费周期**中的**分配的资源**，**费率**。可以选择一个**用户**，显示之前每个**计费周期**用户**分配的资源**和**费率**。）
    - Used（使用：显示各个用户当前**使用周期**实际使用的**资源**，**费率**。可以选择一个**用户**，显示之前每个**使用周期**用户**使用的资源**和**费率**。）
- Resources
  - Dashboard（个人目前已经使用的资源和被分配的资源，project admin被分配的资源即是被Domain分配的资源分给各个user之后剩下的）
  - Instances
  - Volumes
  - Network
    - Private Network
    - Floating IP
  - Images


## Normal User

- Identity
  - My Account（修改学号、邮箱、密码）
  - Projects（显示Domain中的所有Projects，只读）
  - Users （只显示当前project的，只读）
- Expenses
  - Dashboard（显示账号余额，提供充值入口）
  - Transactions（交易记录，提供当前账号的交易信息：时间、交易额、原因（管理费）、余额）
  - User（用户计费）
    - Allocated（分配：显示当前用户**计费周期**的**分配的资源**和**应交的费用**。再显示当前用户之前所有**计费周期**被**分配的资源**和**费用**。）
    - Used（使用：显示当前用户**使用周期**的**已被使用的资源**和**分配资源应交的费用**。再显示当前用户之前所有**使用周期**的**使用的资源**和**费用**。）
    - Transactions（交易记录。显示和当前Project有关的交易记录（project给Domain钱）：时间、支付人、接收人、费用、原因（管理费、Project支出））
- Resources
  - Dashboard（个人已经使用的资源和被分配的资源，资源使用记录，参考horizon的dashboard界面）
  - Instances
  - Volumes
  - Network
    - Private Network
    - Floating IP
  - Images